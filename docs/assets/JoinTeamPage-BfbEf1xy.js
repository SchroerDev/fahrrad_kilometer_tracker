import{r as _,o as h,u as D,s as m,c as g,w as t,a,b as N,d as n,e as s,f as l,g as d,h as V,i as C,t as M}from"./index-Di_CKd83.js";const j={key:0},q={key:1},E={key:2},S={__name:"JoinTeamPage",setup(I){const y=D();N();const r=_(!0),v=_(!1),o=_("");return h(async()=>{r.value=!0;const c=y.params.teamId,{data:{user:e}}=await m.auth.getUser();if(!e){o.value="Du musst eingeloggt sein, um einem Team beizutreten.",r.value=!1;return}const{data:u}=await m.from("members").select("team_id").eq("user_id",e.id).eq("team_id",c).single();if(u){o.value="Du bist bereits Mitglied in diesem Team.",r.value=!1;return}const{error:i}=await m.from("members").insert([{user_id:e.id,team_id:c}]);if(i){o.value="Beitritt fehlgeschlagen: "+i.message,r.value=!1;return}v.value=!0,r.value=!1}),(c,e)=>{const u=a("v-card-title"),i=a("v-progress-circular"),f=a("v-alert"),p=a("v-btn"),b=a("v-card-text"),x=a("v-card"),w=a("v-col"),k=a("v-row"),T=a("v-container"),B=a("v-main");return n(),g(B,null,{default:t(()=>[s(T,{class:"d-flex align-center justify-center",style:{"min-height":"calc(80vh - 64px)"},fluid:""},{default:t(()=>[s(k,{justify:"center"},{default:t(()=>[s(w,{cols:"12",sm:"8",md:"6"},{default:t(()=>[s(x,{class:"pa-4 text-center",elevation:"6"},{default:t(()=>[s(u,{class:"text-h5"},{default:t(()=>e[0]||(e[0]=[l("Team beitreten")])),_:1,__:[0]}),s(b,null,{default:t(()=>[r.value?(n(),d("div",j,[s(i,{indeterminate:"",color:"primary"}),e[1]||(e[1]=V("p",{class:"mt-2"},"Beitritt wird geprÃ¼ft...",-1))])):v.value?(n(),d("div",q,[s(f,{type:"success",dense:"",border:"start"},{default:t(()=>e[2]||(e[2]=[l("Du bist dem Team erfolgreich beigetreten!")])),_:1,__:[2]}),s(p,{color:"primary",to:"/my-team",class:"mt-4"},{default:t(()=>e[3]||(e[3]=[l("Zum Team")])),_:1,__:[3]})])):(n(),d("div",E,[o.value?(n(),g(f,{key:0,type:"error",dense:"",border:"start"},{default:t(()=>[l(M(o.value),1)]),_:1})):C("",!0),s(p,{color:"secondary",to:"/",class:"mt-4"},{default:t(()=>e[4]||(e[4]=[l("Zur Startseite")])),_:1,__:[4]})]))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})}}};export{S as default};
